# PDF上传功能测试清单

## 测试前准备

- [x] 已安装所有依赖：`npm install`
- [x] 开发服务器已启动：`npm run dev`
- [ ] 准备测试用的PDF文件（建议准备不同大小和内容的文件）
- [ ] 确保`.env.local`配置正确（Supabase和OpenRouter API密钥）

## 功能测试

### 1. PDF文件上传

#### 1.1 文件选择
- [ ] 点击"选择图片"按钮可以选择PDF文件
- [ ] 文件选择器显示PDF格式选项
- [ ] 选择PDF文件后正常加载

#### 1.2 拖拽上传
- [ ] 可以拖拽PDF文件到上传区域
- [ ] 拖拽时显示正确的视觉反馈
- [ ] 拖拽后文件正常加载

#### 1.3 文件验证
- [ ] 上传非PDF文件时显示错误提示
- [ ] 超过500MB的PDF文件显示大小限制提示
- [ ] 未选择分类时提示用户先选择分类

### 2. PDF处理

#### 2.1 封面提取
- [ ] PDF文件上传后显示"AI分析中..."状态
- [ ] 成功提取PDF第一页并转换为PNG
- [ ] 封面图正确显示在预览区域
- [ ] 封面图质量清晰可见

#### 2.2 AI分析
- [ ] AI成功分析PDF封面图
- [ ] 生成合理的标签
- [ ] 生成准确的中文提示词
- [ ] 生成准确的英文提示词

#### 2.3 文件存储
- [ ] 原始PDF文件上传到`material/originals/`
- [ ] 封面PNG上传到`material/`
- [ ] 两个文件都可以通过URL访问
- [ ] 数据库正确保存original_file_url和file_format='pdf'

### 3. 素材展示

#### 3.1 素材卡片
- [ ] PDF素材左上角显示红色"PDF"标识
- [ ] 封面图正确显示
- [ ] 素材标题和标签正确显示
- [ ] 鼠标悬停时显示操作按钮

#### 3.2 下载功能
- [ ] 普通下载按钮下载PNG封面图
- [ ] PDF按钮（红色）正确显示
- [ ] 点击PDF按钮下载原始PDF文件
- [ ] 下载的PDF文件可以正常打开
- [ ] 下载的文件名正确

### 4. 边界情况测试

#### 4.1 文件大小
- [ ] 小PDF文件（<1MB）正常处理
- [ ] 中等PDF文件（10-50MB）正常处理
- [ ] 大PDF文件（50-500MB）正常处理
- [ ] 超大PDF文件（>500MB）正确拒绝

#### 4.2 PDF文件类型
- [ ] 纯文本PDF正常处理
- [ ] 图片PDF正常处理
- [ ] 混合内容PDF正常处理
- [ ] 多页PDF正常处理（只提取第一页）
- [ ] 加密PDF处理（可能失败，需要提示）

#### 4.3 错误处理
- [ ] 损坏的PDF文件显示错误提示
- [ ] 网络错误时显示适当提示
- [ ] 存储失败时回滚操作
- [ ] 数据库保存失败时清理已上传文件

### 5. 性能测试

- [ ] 小文件（<5MB）处理时间 < 15秒
- [ ] 中等文件（5-20MB）处理时间 < 45秒
- [ ] 大文件（20-50MB）处理时间 < 90秒

### 6. 兼容性测试

#### 6.1 浏览器兼容性
- [ ] Chrome浏览器正常工作
- [ ] Firefox浏览器正常工作
- [ ] Edge浏览器正常工作

### 7. 向后兼容性

- [ ] 现有的PNG/JPG素材仍然正常显示
- [ ] 现有的PSD素材仍然正常显示
- [ ] 现有的上传流程不受影响
- [ ] 现有的下载功能正常工作

### 8. UI/UX测试

- [ ] 上传进度有适当的视觉反馈
- [ ] 错误消息清晰易懂
- [ ] PDF标识醒目易识别（红色）
- [ ] 下载按钮位置合理
- [ ] 响应式设计在不同屏幕尺寸下正常

## 快速测试步骤

### 最小可行测试（5分钟）

1. **上传测试**
   - 访问 http://localhost:3000
   - 点击"素材上传"
   - 选择"古代男"分类
   - 上传一个小PDF文件（<5MB）
   - 等待AI分析完成
   - 点击"确认上传"

2. **显示测试**
   - 点击"素材库"
   - 选择"古代男"分类
   - 找到刚上传的PDF素材
   - 确认左上角有红色"PDF"标识

3. **下载测试**
   - 鼠标悬停在PDF素材上
   - 点击红色"PDF"按钮
   - 确认PDF文件开始下载
   - 打开下载的PDF确认内容正确

## 问题记录

### 发现的问题

| 问题编号 | 问题描述 | 严重程度 | 状态 | 备注 |
|---------|---------|---------|------|------|
|         |         |         |      |      |

### 待优化项

- [ ] 添加上传进度条
- [ ] 优化大文件处理速度
- [ ] 添加批量上传功能
- [ ] 改进错误提示信息
- [ ] 添加PDF多页预览功能

## 测试结论

- 测试日期：
- 测试人员：
- 测试环境：Windows + Chrome
- 整体评价：
- 是否可以继续开发：□ 是  □ 否

## 备注

**当前状态**：
- ✅ 代码已完成
- ✅ 依赖已安装（pdf-to-img）
- ✅ 开发服务器已启动（http://localhost:3000）
- ⏳ 等待测试

**测试建议**：
1. 先用小文件测试基本功能
2. 再用大文件测试性能
3. 最后测试边界情况和错误处理
